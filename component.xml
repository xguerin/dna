<?xml version="1.0" encoding="UTF-8"?>

<component author="xavier.guerin@imag.fr" unique="true" wrapper="false">

  <id name="DnaInterfaceLibrary" short_name="DnaIF" version="1.0"/>

  <provide>

    <!-- Assert -->

    <method name="dna_checkpoint" return_type="">
      <argument name="condition" type="boolean" direction="in"/>
    </method>

    <!-- Configuration -->

    <definition name="DNA_NAME_LENGTH"/>
    <definition name="DNA_FILENAME_LENGTH"/>
    <definition name="DNA_PATH_LENGTH"/>
    <definition name="DNA_MAX_CPU"/>
    <definition name="DNA_MAX_FILE"/>
    <definition name="DNA_MAX_SEM"/>
    <definition name="DNA_MAX_THREAD_WAIT_LIST"/>
    <definition name="DNA_THREAD_IDLE_STACK_SIZE"/>
    <definition name="DNA_THREAD_STACK_SIZE"/>

    <!-- Fast C -->

    <method name="dna_memcpy" return_type="access void">
      <argument name="s1" type="access void" direction="in"/>
      <argument name="s2" type="access void" direction="in"/>
      <argument name="n" type="size_t" direction="in"/>
    </method>

    <method name="dna_memset" return_type="access void">
      <argument name="s" type="access void" direction="in"/>
      <argument name="c" type="int32_t" direction="in"/>
      <argument name="n" type="size_t" direction="in"/>
    </method>

    <method name="dna_strcpy" return_type="string">
      <argument name="s1" type="string" direction="in"/>
      <argument name="s2" type="string" direction="out"/>
    </method>

    <method name="dna_strcat" return_type="string">
      <argument name="s1" type="string" direction="inout"/>
      <argument name="s2" type="string" direction="in"/>
    </method>

    <method name="dna_strcmp" return_type="int32_t">
      <argument name="s1" type="string" direction="in"/>
      <argument name="s2" type="string" direction="in"/>
    </method>

    <method name="dna_strlen" return_type="size_t">
      <argument name="s" type="string" direction="in"/>
    </method>

    <method name="dna_atoi" return_type="int32_t">
      <argument name="alpha" type="string" direction="in"/>
    </method>

    <method name="dna_itoa" return_type="int32_t">
      <argument name="integer" type="int32_t" direction="in"/>
      <argument name="buffer" type="string" direction="out"/>
    </method>
 
    <!-- Driver management -->

    <definition name="DNA_GET_DEVICE_SIZE"/>
    <definition name="DNA_SET_DEVICE_SIZE"/>
    <definition name="DNA_SET_NONBLOCKING_IO"/>
    <definition name="DNA_SET_BLOCKING_IO"/>
    <definition name="DNA_GET_READ_STATUS"/>
    <definition name="DNA_GET_WRITE_STATUS"/>
    <definition name="DNA_GET_INFO"/>
    <definition name="DNA_CONTROL_CODES_END"/>
    <definition name="DNA_CHARACTER_DEVICE"/>
    <definition name="DNA_BLOCK_DEVICE"/>

    <type name="driver_t"/>
    <type name="device_cmd_t"/>
    <type name="device_info_t"/>

    <method name="driver_load" return_type="status_t">
      <argument name="name" type="string" direction="in"/>
      <argument name="driver" type="access driver_t" direction="out"/>
    </method>

    <!-- File system management -->

    <type name="filesystem_t"/>
    <type name="filesystem_cmd_t"/>

    <method name="filesystem_load" return_type="status_t">
      <argument name="name" type="string" direction="in"/>
      <argument name="fs" type="access filesystem_t" direction="out"/>
    </method>

    <!-- Status management -->

    <type name="status_t"/>

  </provide>

  <require>
    <!-- CPU Hooks -->

    <method name="cpu_compare_and_swap" return_type="int32_t">
      <argument name="lock" type="int32_t" direction="inout"/>
      <argument name="old" type="int32_t" direction="in"/>
      <argument name="new" type="int32_t" direction="in"/>
    </method>

    <!-- Core Manager hooks -->

    <type name="spinlock_t"/>
  </require>

</component>
